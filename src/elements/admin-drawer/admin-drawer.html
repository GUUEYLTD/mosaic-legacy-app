<link rel="import" href="../../../bower_components/polymer/polymer.html" />
<link rel="import" href="../../../bower_components/app-layout/app-drawer/app-drawer.html" />
<link rel="import" href="../../../bower_components/app-layout/app-toolbar/app-toolbar.html" />
<link rel="import" href="../../../bower_components/paper-listbox/paper-listbox.html" />
<link rel="import" href="../../../bower_components/paper-item/paper-item.html" />
<link rel="import" href="../../../bower_components/paper-item/paper-item-body.html" />
<link rel="import" href="../../../bower_components/paper-item/paper-icon-item.html" />
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html" />
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html" />
<link rel="import" href="../../../bower_components/iron-icons/communication-icons.html" />
<link rel="import" href="../../../bower_components/iron-icons/social-icons.html" />
<link rel="import" href="../../../bower_components/paper-toggle-button/paper-toggle-button.html" />
<link rel="import" href="../../../bower_components/iron-image/iron-image.html" />
<link rel="import" href="../../../bower_components/iron-selector/iron-selector.html" />

<!--
`admin-drawer`
drawer for admin functions

@demo demo/index.html
-->

<dom-module id="admin-drawer">

  <template>

    <style>
      app-header {
        background-color: var(--app-primary-color);
        color: #FFFFFF;
      }

      app-header paper-icon-button {
        --paper-icon-button-ink-color: white;
      }

      app-drawer {
        z-index:50;
        color:#FFFFFF;
        --app-drawer-content-container: {
          background-color: #37474F;
        }
      }

      app-toolbar {
        --app-toolbar-font-size: 14px;
      }

      paper-listbox {
        background-color: #37474F;
        color: #FFFFFF;
      }

      .drawer-list {
        margin: 0 20px;
      }

      .drawer-list a {
        display: block;
        padding: 0 16px;
        line-height: 40px;
        text-decoration: none;
        color: var(--app-secondary-color);
        text-decoration: none;
      }

      .drawer-list a .iron-selected {
        color: pink;
        font-weight: bold;
      }

      .drawer-list a .subroute {
        padding-left: 32px;
      }

      app-toolbar {
        background-color: #263238;
        min-height: 150px;
      }

      paper-listbox a {
        text-decoration: none;
        color: inherit;
      }

      .username {
        margin: 20px 0 20px 20px;
      }

      .divider {
        height: 1px;
        width: 100%;
        background-color: grey;
      }

      paper-toggle-button {
        display: inline-block;
        --paper-toggle-button-checked-bar-color: var(--paper-green-500);
        --paper-toggle-button-checked-button-color: var(--paper-green-500);
        --paper-toggle-button-checked-ink-color: var(--paper-green-500);
        --paper-toggle-button-unchecked-bar-color: var(--paper-red-900);
        --paper-toggle-button-unchecked-button-color: var(--paper-red-900);
        --paper-toggle-button-unchecked-ink-color: var(--paper-red-900);
      }

      .toggleLabel {
        flex-grow: 1;
      }

      iron-image {
        height: 50px;
        width: 50px;
        border-radius: 50%;
        margin-left: 20px;
        margin-top: 20px;
      }

      .adrawer-list: {
        color: #FFFFFF;
      }

      .adrawer-list a.iron-selected {
        color: #FAD100;
        font-weight: bold;
      }

      .adrawer-list  a.iron-selected.disabled-link {
        opacity: 0.7;
        color: grey;
      }

      .disabled-link {
        opacity: 0.7;
        color: grey;
      }

      .disabled-link:hover {
        cursor: not-allowed;
      }

    </style>

    <app-drawer id="adminDrawer" position="start" opened="{{opened}}">
      <app-toolbar>
        <iron-image
          src="../../../images/defaultAvatar.png"
          top-item
          sizing="cover">
        </iron-image>
        <p class="username" bottom-item>
          [[user.email]]
        </p>
      </app-toolbar>
      <paper-listbox>
        <iron-selector selected="[[page]]" attr-for-selected="name" class="adrawer-list" role="navigation">
          <a name="ad-dash" on-tap="close" href$="/[[home]]/admin/ad-dash/[[admin]]" tabindex="-1">
            <paper-item>
              <paper-icon-item>
                <iron-icon icon="icons:dashboard" item-icon></iron-icon>
                Dashboard
              </paper-icon-item>
            </paper-item>
          </a>

          <a name="ad-profile" on-tap="close" href$="/[[home]]/admin/ad-profile/[[admin]]" tabindex="-1">
            <paper-item>
              <paper-icon-item>
                <iron-icon icon="social:location-city" item-icon></iron-icon>
                Company Profile
              </paper-icon-item>
            </paper-item>
          </a>

          <a name="ad-payment" on-tap="close" href$="/[[home]]/admin/ad-payment/[[admin]]" tabindex="-1">
            <paper-item>
              <paper-icon-item>
                <iron-icon icon="icons:payment" item-icon></iron-icon>
                Payment
              </paper-icon-item>
            </paper-item>
          </a>

          <a name="ad-users" on-tap="close" href$="/[[home]]/admin/ad-users/[[admin]]" tabindex="-1">
            <paper-item>
              <paper-icon-item>
                <iron-icon icon="social:group" item-icon></iron-icon>
                Users
              </paper-icon-item>
            </paper-item>
          </a>

          <a name="ad-settings" on-tap="close" href$="/[[home]]/admin/ad-settings/[[admin]]" tabindex="-1">
            <paper-item>
              <paper-icon-item>
                <iron-icon icon="icons:settings" item-icon></iron-icon>
                Settings
              </paper-icon-item>
            </paper-item>
          </a>

          <a name="ad-reports" on-tap="close" href$="/[[home]]/admin/ad-reports/[[admin]]" tabindex="-1">
            <paper-item>
              <paper-icon-item>
                <iron-icon icon="icons:assessment" item-icon></iron-icon>
                Reports
              </paper-icon-item>
            </paper-item>
          </a>

          <a name="ad-support" on-tap="close" href$="/[[home]]/admin/ad-support/[[admin]]" tabindex="-1">
            <paper-item>
              <paper-icon-item>
                <iron-icon icon="communication:live-help" item-icon></iron-icon>
                Support
              </paper-icon-item>
            </paper-item>
          </a>
        </iron-selector>
      </paper-listbox>
      <div class="divider"></div>
      <paper-listbox>
        <paper-item>
          <p class="toggleLabel">
            Version control
          </p>
          <paper-toggle-button
            name="Version Control"
            toggles
            value="{{vcActive}}">
          </paper-toggle-button>
        </paper-item>
      </paper-listbox>

    </app-drawer>

  </template>

  <script>

    Polymer({
      is:'admin-drawer',
      properties:{
        //user from auth object used to get current email
        user:{
          type: Object
        },
        //admin string... may be redundant at this point...
        admin: {
          type:String,
          value:"default"
        },
        //the current home for the account in use... calculated on main app page
        home: {
          type:String,
          value:"default"
        },
        //the current page selected
        page: {
          type:String
        },
        //whether or not drawer is open
        opened: {
          type:Boolean,
          value:false
        },
        //passed in from main app. depending on type different styles are applied to the menu links
        userType: {
          type:String,
          observer:"_userTypeChanged"
        },
        //pages that are allowed for non admin/manager usertypes passed in from main app file.
        allowedPages: {
          type:Array
        },
        //will be used in the future to dictate whether or not version control is active... will need to be linked to firebase.
        vcActive: {
          type:Boolean,
          value:false
        }
      },
      //depending on user type certain links are greyed out actual route prevention happens on page-change-middleware
      _userTypeChanged:function(userType) {
        var links = Polymer.dom(this.$$(".adrawer-list")).children;
        if(userType === "careWorker") {
          links.forEach(function(link) {
            if(this.allowedPages.indexOf(link.name) === -1) {
              link.classList.add("disabled-link");
            };
          }.bind(this));
        } else {
          links.forEach(function(link) {
            link.classList.remove("disabled-link");
          }.bind(this));
        };
      },
      //lose the admin drawer
      close:function() {
        this.$.adminDrawer.close();
      }
    });

  </script>

</dom-module>
