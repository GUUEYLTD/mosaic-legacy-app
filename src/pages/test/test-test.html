<link rel="import" href="../../../bower_components/polymer/polymer.html" />
<link rel="import" href="../../../bower_components/paper-button/paper-button.html" />
<link rel="import" href="../../../bower_components/iron-ajax/iron-ajax.html" />


<dom-module id="test-test">
  <template>

    <iron-ajax
      id="authCall"
      handle-as="json"
      on-response="handleAuth"
      method="POST"
      content-type="application/json">
    </iron-ajax>

    <style include="common-styles">
      .main{
        margin: 50px 10% 50px 10%;
        width:80%;
        min-height:700px;
      }

    </style>

    <paper-card class="main">
      <paper-button on-tap="sendAuth">send auth</paper-button>
    </paper-card>

  </template>

  <script>

      Polymer({
        is: 'test-test',

        ready:function(){
          this.fire("pageLoaded",{page: this.page});
        },

        sendAuth: function() {
          this.user.getToken()
            .then(function(token) {
              this.$.authCall.body = {
                token: token
              };
              this.$.authCall.url="http://localhost:3000/verify/auth";
              this.$.authCall.generateRequest();
            }.bind(this));
        },

        handleAuth: function(e) {
          console.log(e.detail.response);
        }

      });

  </script>

</dom-module>
