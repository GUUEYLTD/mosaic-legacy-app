<link rel="import" href="dependencies.html" />
<dom-module id="test-test">

  <template>
    <firebase-auth
      id="auth"
      app-name="main"
      user="{{user2}}"
      signed-in="{{signedIn2}}"
      status-known="{{statusKnown2}}"
      on-error="handleError">
    </firebase-auth>

    [[user2.email]]

    <paper-button on-tap="resetPass">change pass</paper-button>

    <paper-button on-tap="verifyEmail">verify email</paper-button>

    <paper-input value="{{newEmail}}" label="new email"></paper-input>

    <paper-button on-tap="changeEmail">change email</paper-button>

    <paper-button on-tap="updateField">update user field</paper-button>

  </template>

  <script>

    Polymer({

      is: 'test-test',
      observers:[
        "checkStatus(statusKnown2)"
      ],
      resetPass:function(){
        this.$.auth.auth.sendPasswordResetEmail(this.user2.email)
          .then(function() {
          console.log("email sent");
          }, function(error) {
          console.log(error);
          });
      },
      verifyEmail:function(){
        this.$.auth.user.sendEmailVerification()
          .then(function() {
          console.log("email sent");
        }.bind(this), function(error) {
          console.log(error);
        }.bind(this));
      },
      changeEmail:function(){
        this.$.auth.user.updateEmail(this.newEmail)
          .then(function(){
            console.log("email changed");
          }, function(error){
            console.log(error);
          });
      },
      checkStatus:function(status){
        if(status){
          console.log(this.user2);
          console.log(this.user2.emailVerified);
        };
      },
      updateField:function(){
        this.$.auth.user.updateProfile({
          emailVerified:false
        }).then(function() {
          console.log("updated");
        }, function(error) {
          console.log(error);
        });
      }
    });

  </script>

</dom-module>
